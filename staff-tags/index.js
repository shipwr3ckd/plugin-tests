(function(u,a,l,n,C,s,_,g){"use strict";const{Permissions:A}=n.constants,{computePermissions:M}=l.findByProps("computePermissions","canEveryoneRole"),v=l.findByStoreName("GuildMemberStore"),R=[n.i18n.Messages.AI_TAG,n.i18n.Messages.BOT_TAG_SERVER,n.i18n.Messages.SYSTEM_DM_TAG_SYSTEM,n.i18n.Messages.GUILD_AUTOMOD_USER_BADGE_TEXT,n.i18n.Messages.REMIXING_TAG],S=[{text:"WEBHOOK",condition:function(e,i,t){return t.isNonUserBot()}},{text:"OWNER",backgroundColor:s.rawColors.ORANGE_345,condition:function(e,i,t){return e?.ownerId===t.id}},{text:n.i18n.Messages.BOT_TAG_BOT,condition:function(e,i,t){return t.bot},verified:function(e,i,t){return t.isVerifiedBot()}},{text:"ADMIN",backgroundColor:s.rawColors.RED_560,permissions:["ADMINISTRATOR"]},{text:"MANAGER",backgroundColor:s.rawColors.GREEN_345,permissions:["MANAGE_GUILD","MANAGE_CHANNELS","MANAGE_ROLES","MANAGE_WEBHOOKS"]},{text:"MOD",backgroundColor:s.rawColors.BLUE_345,permissions:["MANAGE_MESSAGES","KICK_MEMBERS","BAN_MEMBERS"]}];function G(e,i,t){let c;if(e){const r=M({user:t,context:e,overwrites:i?.permissionOverwrites});c=Object.entries(A).map(function(o){let[d,f]=o;return r&f?d:""}).filter(Boolean)}for(const r of S)if(r.condition?.(e,i,t)||r.permissions?.some(function(o){return c?.includes(o)})){let o=a.storage.useRoleColor?v.getMember(e?.id,t.id)?.colorString:void 0,d=o||(r.backgroundColor??s.rawColors.BRAND_500),f=o||!r.textColor?n.chroma(d).get("lab.l")<70?s.rawColors.WHITE_500:s.rawColors.BLACK_500:r.textColor;return{...r,textColor:f,backgroundColor:d,verified:typeof r.verified=="function"?r.verified(e,i,t):r.verified??!1,condition:void 0,permissions:void 0}}}const N=l.findByName("getTagProperties",!1),T=l.findByStoreName("GuildStore"),B=l.findByStoreName("ChannelStore");function x(){return C.after("default",N,function(e,i){let[{message:t}]=e;if(!R.includes(i.tagText)){const c=B.getChannel(t.channel_id),r=T.getGuild(c?.guild_id),o=G(r,c,t.author);if(o)return{...i,tagText:o.text,tagTextColor:o.textColor?n.ReactNative.processColor(n.chroma(o.textColor).hex()):void 0,tagBackgroundColor:o.backgroundColor?n.ReactNative.processColor(n.chroma(o.backgroundColor).hex()):void 0,tagVerified:o.verified,tagType:void 0}}})}const{ScrollView:O}=g.General,{FormSection:b,FormSwitchRow:p}=g.Forms;function h(){return _.useProxy(a.storage),React.createElement(O,{style:{flex:1}},React.createElement(b,{title:"Tag style"},React.createElement(p,{label:"Use top role color for tag backgrounds",value:a.storage.useRoleColor,onValueChange:function(e){a.storage.useRoleColor=e}})))}let E=[];var w={onLoad:function(){a.storage.useRoleColor??=!1,E.push(x())},onUnload:function(){return E.forEach(function(e){return e()})},settings:h};return u.default=w,Object.defineProperty(u,"__esModule",{value:!0}),u})({},vendetta.plugin,vendetta.metro,vendetta.metro.common,vendetta.patcher,vendetta.ui,vendetta.storage,vendetta.ui.components);
