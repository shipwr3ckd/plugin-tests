(function(r,a,f,t,n,p,y,i){"use strict";const c=a.findByProps("openLazy","hideActionSheet"),u=a.findByProps("ActionSheetRow")?.ActionSheetRow??p.Forms.FormRow,g=a.findByStoreName("MessageStore"),A=a.findByProps("sendMessage","receiveMessage"),S=t.stylesheet.createThemedStyleSheet({iconComponent:{width:24,height:24,tintColor:"#5865F2"}});function v(){f.before("openLazy",c,function(w){let[,I,h]=w;const o=h?.message;I!=="MessageLongPressActionSheet"||!o||h.component.then(function(N){const R=f.before("default",N,function(b,B){t.React.useEffect(function(){return function(){return R()}},[]);const d=y.findInReactTree(B,function(e){return Array.isArray(e)&&e.find(function(l){return l?.type?.displayName===u.displayName})});if(!d)return;const M=d.findIndex(function(e){return e.props.label?.includes("Reply")})+1;d.splice(M,0,t.React.createElement(u,{label:"Quote Message",icon:t.React.createElement(u.Icon,{source:n.getAssetIDByName("Quote"),IconComponent:function(){return t.React.createElement(t.ReactNative.Image,{style:S.iconComponent,source:n.getAssetIDByName("Quote")})}}),onPress:async function(){i.showToast("\u{1F3A8} Generating quote\u2026",n.getAssetIDByName("Small"));const e=g.getMessage(o.channel_id,o.id);if(!e){i.showToast("\u274C Message not found.",n.getAssetIDByName("Small")),c.hideActionSheet();return}const l=`https://cdn.discordapp.com/avatars/${e.author.id}/${e.author.avatar}.png?size=128`,C={text:e.content||"[No text]",username:e.author.username,timestamp:e.timestamp,avatarUrl:l};try{const s=await fetch("https://quote-cardgen.onrender.com/api/generate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(C)});if(!s.ok)throw new Error("API failed");const P=await s.blob(),m=new FormData;m.append("file",P,"quote.png"),A.sendMessage(o.channel_id,{content:"",messageReference:{message_id:o.id},files:m,invalidEmojis:[],validNonShortcutEmojis:[],attachments:[]}),i.showToast("\u2705 Quote sent!",n.getAssetIDByName("Check"))}catch(s){console.error(s),i.showToast("\u274C Quote failed.",n.getAssetIDByName("Small"))}finally{c.hideActionSheet()}}}))})})})}return r.default=v,Object.defineProperty(r,"__esModule",{value:!0}),r})({},vendetta.metro,vendetta.patcher,vendetta.metro.common,vendetta.ui.assets,vendetta.ui.components,vendetta.utils,vendetta.ui.toasts);
