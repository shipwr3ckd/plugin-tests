(function(n,a,o,c,u,d,y){"use strict";const f=a.findByProps("openLazy","hideActionSheet"),r=a.findByProps("ActionSheetRow")?.ActionSheetRow;a.findByStoreName("MessageStore");const m=a.findByStoreName("UserStore");function p(){return c.after("openLazy",f,function(A){let[I,b,B]=A;b==="MessageLongPressActionSheet"&&I.then(function(C){c.after("default",C,function(T,L){const t=B?.message;if(!t)return;const i=y.findInReactTree(L,function(e){return Array.isArray(e)&&e.some(function(s){return s?.type===r})});if(!i)return;const R=Math.max(i.findIndex(function(e){return e?.props?.label==="Copy Text"}),1),U=async function(){try{const e=t.author||m.getUser(t.author?.id),s=new Date(t.timestamp).toISOString(),M={text:t.content,username:e?.username??"Unknown",timestamp:s,avatarUrl:`https://cdn.discordapp.com/avatars/${e?.id}/${e?.avatar}.png?size=256`},h=await fetch("https://quote-cardgen.onrender.com/api/generate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(M)});if(!h.ok){d.showToast("\u274C Failed to generate quote");return}const l=await h.arrayBuffer(),N=btoa(String.fromCharCode(...new Uint8Array(l)));window.vendetta.plugins.sendMessage(t.channel_id,{content:"",attachments:[{id:"0",filename:"quote.png",content_type:"image/png",size:l.byteLength,url:`data:image/png;base64,${N}`}]})}catch(e){d.showToast("\u274C Error sending quote"),console.error("Quote error:",e)}finally{f.hideActionSheet()}};i.splice(R,0,o.React.createElement(r,{label:"Quote Message",icon:o.React.createElement(r.Icon,{source:u.getAssetIDByName("ic_message"),IconComponent:function(){return o.React.createElement(o.ReactNative.Image,{style:{width:24,height:24},source:u.getAssetIDByName("ic_message")})}}),onPress:U}))})})})}let g;const S=function(){g=p()},v=function(){g?.()},w={};return n.onLoad=S,n.onUnload=v,n.settings=w,n})({},vendetta.metro,vendetta.metro.common,vendetta.patcher,vendetta.ui.assets,vendetta.ui.toasts,vendetta.utils);
