(function(n,u,t,r,i,m){"use strict";t.findByStoreName("MessageStore"),t.findByStoreName("ChannelStore");const g=t.findByStoreName("PendingReplyStore");let d;var p={onLoad(){const f=t.findByStoreName("MessageStore");d=u.before("sendMessage",f,function(y){let[c,l]=y;if(!l.content?.startsWith("/quote"))return;const o=g.getPendingReply(c)?.message;if(!o){i.showToast("Use /quote as a reply to a message",r.getAssetIDByName("Small"));return}const{content:h,timestamp:v,author:a}=o,S=a.global_name||a.username,N=`https://cdn.discordapp.com/avatars/${a.id}/${a.avatar}.png?size=4096`;fetch("https://quote-cardgen.onrender.com/api/generate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:h,username:S,timestamp:v,avatarUrl:N})}).then(async function(e){if(!e.ok)throw new Error(await e.text());const M=await e.blob(),s=new FileReader;s.onloadend=function(){const w=s.result;m.ReactNative.NativeModules.ImagePickerModule.uploadImage(c,{content:"",file:{name:"quote.png",type:"image/png",data:w.split(",")[1]},replyMessageId:o.id})},s.readAsDataURL(M)}).catch(function(e){console.error("Quote Error:",e),i.showToast("Failed to send quote image",r.getAssetIDByName("Small"))}),l.content=""})},onUnload(){d?.()}};return n.default=p,Object.defineProperty(n,"__esModule",{value:!0}),n})({},vendetta.patcher,vendetta.metro,vendetta.ui.assets,vendetta.ui.toasts,vendetta.metro.common);
