(function(a,o,t,c,r,u,y){"use strict";const d=o.findByProps("openLazy","hideActionSheet"),h=o.findByProps("ActionSheetRow")?.ActionSheetRow,p=o.findByStoreName("MessageStore"),m=t.stylesheet.createThemedStyleSheet({icon:{width:24,height:24,tintColor:"#fff"}});function S(){return c.after("openLazy",d,function(w){let[I,N,s]=w;N!=="MessageLongPressActionSheet"||!s?.message||I.then(function(E){const _=c.after("default",E,function(T,M){t.React.useEffect(function(){return function(){return _()}},[]);const l=y.findInReactTree(M,function(n){return Array.isArray(n)&&n.some(function(i){return i?.type?.name==="ActionSheetRow"})});if(!l)return;const e=p.getMessage(s.message.channel_id,s.message.id);if(!e?.content)return;const g=u.getAssetIDByName("ic_message_copy"),P=async function(){try{const n=await fetch("https://quote-cardgen.onrender.com",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({content:e.content,author:{name:e.author.username,avatar:`https://cdn.discordapp.com/avatars/${e.author.id}/${e.author.avatar}.png?size=128`},timestamp:e.timestamp})}),{url:i}=await n.json();t.FluxDispatcher.dispatch({type:"SEND_MESSAGE",optimistic:!0,message:{channelId:e.channel_id,content:i,validNonShortcut:!0,repliedMessageId:e.id}}),r.showToast("Quote sent!",u.getAssetIDByName("toast_image"))}catch(n){console.error("QuoteCard error:",n),r.showToast("Failed to generate quote.")}finally{d.hideActionSheet()}};l.splice(2,0,t.React.createElement(h,{label:"Quote Message",icon:t.React.createElement(h.Icon,{source:g,IconComponent:function(){return t.React.createElement(t.ReactNative.Image,{source:g,style:m.icon})}}),onPress:P}))})})})}let f;const v=function(){f=S()},A=function(){f?.()},R={};return a.onLoad=v,a.onUnload=A,a.settings=R,a})({},vendetta.metro,vendetta.metro.common,vendetta.patcher,vendetta.ui.toasts,vendetta.ui.assets,vendetta.utils);
