(function(t,d,n){"use strict";const c=n.findByStoreName("MessageStore"),{uploadLocalFiles:u}=n.findByProps("uploadLocalFiles"),l=n.findByProps("getToken").getToken();let i;var m={onLoad(){i=d.registerCommand({name:"quote",displayName:"quote",description:"Quote a replied message as an image",displayDescription:"Quote a replied message as an image",applicationId:"-1",inputType:1,type:1,execute:p})},onUnload(){i?.()}};async function p(C,r){const a=r?.message?.message_reference;if(!a?.message_id)return{content:"\u274C Please reply to a message when using `/quote`."};const s=c.getMessage(a.channel_id,a.message_id);if(!s)return{content:"\u274C Couldn't find the replied message."};const{content:g,timestamp:y,author:o}=s,f=`https://cdn.discordapp.com/avatars/${o.id}/${o.avatar}.png?size=4096`;try{const e=await fetch("https://quote-cardgen.onrender.com/api/generate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:g,username:o.username,timestamp:y,avatarUrl:f})});if(!e.ok)return{content:"\u274C Failed to generate quote card."};const h=await(await e.blob()).arrayBuffer(),v=new Uint8Array(h),w={id:Date.now().toString(),filename:"quote.png",mimeType:"image/png",data:v},q={content:"",tts:!1,invalidEmojis:[],validNonShortcutEmojis:[]};return await u([{channelId:r.channel.id,items:[w],parsedMessage:q,token:l}]),null}catch(e){return console.error("Quote error:",e),{content:"\u274C An error occurred while sending the quote."}}}return t.default=m,Object.defineProperty(t,"__esModule",{value:!0}),t})({},vendetta.commands,vendetta.metro);
