(function(i,n,o,l,f,a,y){"use strict";const g=n.findByProps("openLazy","hideActionSheet"),u=n.findByProps("ActionSheetRow")?.ActionSheetRow;n.findByStoreName("MessageStore");const m=n.findByStoreName("UserStore");let h;const v=function(){h?.()};function S(){h=l.after("openLazy",g,function(A){let[I,R,P]=A;R==="MessageLongPressActionSheet"&&I.then(function(C){l.after("default",C,function(L,M){const t=P?.message;if(!t)return;const r=y.findInReactTree(M,function(e){return Array.isArray(e)&&e.some(function(c){return c?.type===u})});if(!r||r.some(function(e){return e?.props?.label==="Quote Message"}))return;const U=Math.max(r.findIndex(function(e){return e?.props?.label==="Copy Text"}),1),Q=async function(){try{const e=t.author??m.getUser(t.author?.id),c=new Date(t.timestamp).toISOString(),T={text:t.content,username:e?.username??"Unknown",timestamp:c,avatarUrl:`https://cdn.discordapp.com/avatars/${e?.id}/${e?.avatar}.png?size=4096`},d=await fetch("https://quote-cardgen.onrender.com/api/generate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(T)});if(!d.ok){a.showToast("\u274C Failed to generate quote"),console.error("\u274C Quote API returned:",d.status);return}const p=await d.json(),s=p?.url;if(!s||typeof s!="string"){a.showToast("\u274C Invalid image URL returned"),console.error("\u274C Quote API response missing or invalid URL:",p);return}const B=n.findByProps("sendMessage").sendMessage;B(t.channel_id,{content:s}),a.showToast("\u2705 Quote sent!"),console.log("\u2705 Quote URL:",s)}catch(e){a.showToast("\u274C Error sending quote"),console.error("\u274C Quote generation failed:",e)}finally{g.hideActionSheet()}};r.splice(U,0,o.React.createElement(u,{label:"Quote Message",icon:o.React.createElement(u.Icon,{source:f.getAssetIDByName("ic_message"),IconComponent:function(){return o.React.createElement(o.ReactNative.Image,{style:{width:24,height:24},source:f.getAssetIDByName("ic_message")})}}),onPress:Q}))})})})}var w={onLoad:S,onUnload:v};return i.default=w,Object.defineProperty(i,"__esModule",{value:!0}),i})({},vendetta.metro,vendetta.metro.common,vendetta.patcher,vendetta.ui.assets,vendetta.ui.toasts,vendetta.utils);
