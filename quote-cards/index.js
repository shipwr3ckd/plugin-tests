(function(o,n,a,u,d,l,y){"use strict";const f=n.findByProps("openLazy","hideActionSheet"),r=n.findByProps("ActionSheetRow")?.ActionSheetRow;n.findByStoreName("MessageStore");const m=n.findByStoreName("UserStore");let h;function S(){h=u.after("openLazy",f,function(w){let[R,I,b]=w;I==="MessageLongPressActionSheet"&&R.then(function(z){u.after("default",z,function(T,B){const t=b?.message;if(!t)return;const i=y.findInReactTree(B,function(e){return Array.isArray(e)&&e.some(function(s){return s?.type===r})});if(!i)return;const L=Math.max(i.findIndex(function(e){return e?.props?.label==="Copy Text"}),1),M=async function(){try{const e=t.author||m.getUser(t.author?.id),s=new Date(t.timestamp).toISOString(),N={text:t.content,username:e?.username??"Unknown",timestamp:s,avatarUrl:`https://cdn.discordapp.com/avatars/${e?.id}/${e?.avatar}.png?size=256`},p=await fetch("https://quote-cardgen.onrender.com/api/generate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(N)});if(!p.ok){l.showToast("\u274C Failed to generate quote");return}const g=await p.blob(),c=new FileReader;c.onloadend=function(){const P=c.result;window.vendetta.plugins.sendMessage(t.channel_id,{content:"",attachments:[{id:"0",filename:"quote.png",content_type:"image/png",size:g.size,url:P}]})},c.readAsDataURL(g)}catch(e){l.showToast("\u274C Error sending quote"),console.error("Quote error:",e)}finally{f.hideActionSheet()}};i.splice(L,0,a.React.createElement(r,{label:"Quote Message",icon:a.React.createElement(r.Icon,{source:d.getAssetIDByName("ic_message"),IconComponent:function(){return a.React.createElement(a.ReactNative.Image,{style:{width:24,height:24},source:d.getAssetIDByName("ic_message")})}}),onPress:M}))})})})}function v(){h?.()}var A={onLoad(){S()},onUnload(){v()}};return o.default=A,Object.defineProperty(o,"__esModule",{value:!0}),o})({},vendetta.metro,vendetta.metro.common,vendetta.patcher,vendetta.ui.assets,vendetta.ui.toasts,vendetta.utils);
