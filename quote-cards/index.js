(function(s,n,o,l,f,a,y){"use strict";const g=n.findByProps("openLazy","hideActionSheet"),i=n.findByProps("ActionSheetRow")?.ActionSheetRow;n.findByStoreName("MessageStore");const m=n.findByStoreName("UserStore");let h;const S=function(){h?.()};function v(){h=l.after("openLazy",g,function(w){let[I,R,P]=w;R==="MessageLongPressActionSheet"&&I.then(function(C){l.after("default",C,function(B,M){const t=P?.message;if(!t)return;const r=y.findInReactTree(M,function(e){return Array.isArray(e)&&e.some(function(u){return u?.type===i})});if(!r||r.some(function(e){return e?.props?.label==="Quote Message"}))return;const U=Math.max(r.findIndex(function(e){return e?.props?.label==="Copy Text"}),1),N=async function(){try{const e=t.author??m.getUser(t.author?.id),u=new Date(t.timestamp).toISOString(),Q={text:t.content,username:e?.username??"Unknown",timestamp:u,avatarUrl:`https://cdn.discordapp.com/avatars/${e?.id}/${e?.avatar}.png?size=256`},c=await fetch("https://quote-cardgen.onrender.com/api/generate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Q)});if(!c.ok){a.showToast("\u274C Failed to generate quote"),console.error("\u274C Quote API returned:",c.status);return}const p=await c.json(),d=p?.url;if(!d){a.showToast("\u274C No image URL returned"),console.error("\u274C Quote API response missing URL:",p);return}const T=n.findByProps("sendMessage").sendMessage;T(t.channel_id,{content:d}),a.showToast("\u2705 Quote sent!"),console.log("\u2705 Quote URL:",d)}catch(e){a.showToast("\u274C Error sending quote"),console.error("\u274C Quote generation failed:",e)}finally{g.hideActionSheet()}};r.splice(U,0,o.React.createElement(i,{label:"Quote Message",icon:o.React.createElement(i.Icon,{source:f.getAssetIDByName("ic_message"),IconComponent:function(){return o.React.createElement(o.ReactNative.Image,{style:{width:24,height:24},source:f.getAssetIDByName("ic_message")})}}),onPress:N}))})})})}var A={onLoad:v,onUnload:S};return s.default=A,Object.defineProperty(s,"__esModule",{value:!0}),s})({},vendetta.metro,vendetta.metro.common,vendetta.patcher,vendetta.ui.assets,vendetta.ui.toasts,vendetta.utils);
