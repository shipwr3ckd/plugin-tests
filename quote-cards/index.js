(function(s,l,r,t,a){"use strict";const f=r.findByStoreName("MessageStore");r.findByStoreName("ChannelStore");const c=r.findByProps("sendMessage","receiveMessage");function h(i,n){return`https://cdn.discordapp.com/avatars/${i}/${n}.png?size=128`}let m;var p={onLoad(){m=l.after("sendMessage",c,async function(i){let[n,u]=i;if(!u?.content?.startsWith('q"'))return;const d=u?.messageReference?.message_id;if(!d){a.showToast('\u274C Use the quote command (`q"`) as a reply.',t.getAssetIDByName("Small"));return}const e=f.getMessage(n,d);if(!e){a.showToast("\u26A0\uFE0F Original message not found.",t.getAssetIDByName("Small"));return}const y=h(e.author.id,e.author.avatar),v={text:e.content||"[No content]",username:e.author.username,timestamp:e.timestamp,avatarUrl:y};try{a.showToast("\u{1F3A8} Generating image...",t.getAssetIDByName("Small"));const o=await fetch("https://quote-cardgen.onrender.com/api/generate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(v)});if(!o.ok)throw new Error("Image generation failed");const S=await o.blob(),g=new FormData;g.append("file",S,"quote.png"),c.sendMessage(n,{content:"",messageReference:{message_id:d},invalidEmojis:[],validNonShortcutEmojis:[],attachments:[],files:g}),a.showToast("\u2705 Quote sent!",t.getAssetIDByName("Check"))}catch(o){console.error("QuoteCard error:",o),a.showToast("\u274C Failed to send image",t.getAssetIDByName("Small"))}})},onUnload(){m?.()}};return s.default=p,Object.defineProperty(s,"__esModule",{value:!0}),s})({},vendetta.patcher,vendetta.metro,vendetta.ui.assets,vendetta.ui.toasts);
