(function(i,n,r,m){"use strict";n.findByProps("openLazy","hideActionSheet");let l;function y(){l=r.after("openLazy",n.findByProps("openLazy"),function(e,s){let[p,t]=e;if(!t?.[0]?.message)return;const u=t[0].message;r.after("default",s,function(a){let[d]=a;const o=d?.type?.render;o&&r.after("render",o,function(c,f){let[P]=c;const g=P?.actionSheet?.rows;Array.isArray(g)&&g.push({label:"\u{1F4CB} Quote Message",icon:m.getAssetIDByName("Quote"),onPress:function(){return v(u)}})})})})}const h=function(){l?.()};async function v(e){const s=`https://cdn.discordapp.com/avatars/${e.author.id}/${e.author.avatar}.png?size=4096`,p={text:e.content,username:e.author.username,timestamp:e.timestamp,avatarUrl:s};try{const t=await fetch("https://quote-cardgen.onrender.com/api/generate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(p)});if(!t.ok)throw new Error("Quote API failed");const u=await(await t.blob()).arrayBuffer(),a=new File([u],"quote.png",{type:"image/png"}),{uploadLocalFiles:d}=n.findByProps("uploadLocalFiles"),o=n.findByProps("getToken").getToken(),c=[{item:{id:"quote",uri:a.uri??"",originalUri:a.uri??"",mimeType:"image/png",filename:"quote.png",width:800,height:400,playableDuration:0},id:"quote",filename:"quote.png",isImage:!0,isVideo:!1,mimeType:"image/png",origin:1}],f={content:"",tts:!1,invalidEmojis:[],validNonShortcutEmojis:[]};d([{ctx:{channel:e.channel_id},items:c,token:o,parsedMessage:f}])}catch(t){console.error("\u274C Quote generation failed:",t)}}var w={onLoad:y,onUnload:h};return i.default=w,Object.defineProperty(i,"__esModule",{value:!0}),i})({},vendetta.metro,vendetta.patcher,vendetta.ui.assets);
