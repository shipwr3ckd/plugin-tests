(function(s,t,r,d,f,m){"use strict";const p=t.findByProps("openLazy","hideActionSheet"),i=t.findByProps("ActionSheetRow")?.ActionSheetRow,S=t.findByStoreName("MessageStore"),v=t.findByStoreName("UserStore");let l;const I=function(){l?.()};function P(){l=d.after("openLazy",p,function(M){let[R,_]=M;_==="MessageLongPressActionSheet"&&R.then(function(w){d.after("default",w,function(b,x){let[g]=b;const n=m.findInReactTree(x,function(e){return Array.isArray(e)&&e.some(function(a){return a?.type===i})});if(!n||n.some(function(e){return e?.props?.label==="Quote Message"}))return;const h=n.findIndex(function(e){return e?.props?.label==="Reply"}),B=h>-1?h:Math.max(n.findIndex(function(e){return e?.props?.label==="Copy Text"}),0);n.splice(B,0,r.React.createElement(i,{label:"Quote Message",icon:r.React.createElement(i.Icon,{source:f.getAssetIDByName("ic_chat_24px"),IconComponent:function(){return r.React.createElement(r.ReactNative.Image,{style:{width:24,height:24},source:f.getAssetIDByName("ic_chat_24px")})}}),onPress:async function(){try{const e=g?.message?.id,a=g?.message?.channel_id;if(!e||!a)return;const o=S.getMessage(a,e);if(!o)return;const c=o.author??v.getUser(o.author?.id),E={text:o.content.replace(/[\p{Emoji_Presentation}\p{Extended_Pictographic}]/gu,""),username:c?.username??"Unknown",timestamp:new Date(o.timestamp).toISOString(),avatarUrl:`https://cdn.discordapp.com/avatars/${c?.id}/${c?.avatar}.png?size=4096`},y=await fetch("https://quote-cardgen.onrender.com/api/generate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(E)});if(!y.ok)return;const u=(await y.json())?.url;if(!u||typeof u!="string")return;const{sendMessage:N}=t.findByProps("sendMessage");N(a,{content:u})}catch(e){console.error("Quote error",e)}finally{p.hideActionSheet()}}}))})})})}var A={onLoad:P,onUnload:I};return s.default=A,Object.defineProperty(s,"__esModule",{value:!0}),s})({},vendetta.metro,vendetta.metro.common,vendetta.patcher,vendetta.ui.assets,vendetta.utils);
