(function(n,c,a){"use strict";const l=a.findByStoreName("MessageStore"),{uploadLocalFiles:u}=a.findByProps("uploadLocalFiles"),m=a.findByProps("getToken").getToken();let s;var p={onLoad(){s=c.registerCommand({name:"quote",displayName:"quote",description:"Quote a message from a Discord message link",displayDescription:"Quote a message from a Discord message link",applicationId:"-1",inputType:1,type:1,options:[{name:"link",displayName:"link",description:"The Discord message link",displayDescription:"The Discord message link",type:3,required:!0}],execute:y})},onUnload(){s?.()}};function g(o){const e=o.match(/discord\.com\/channels\/(?:\d+|@me)\/(\d+)\/(\d+)/);return e?{channelId:e[1],messageId:e[2]}:null}async function y(o,e){const f=o[0]?.value,r=g(f);if(!r)return{content:"\u274C Invalid message link format."};const{channelId:h,messageId:v}=r,d=l.getMessage(h,v);if(!d)return{content:"\u274C Message not found. It may not be loaded into memory yet."};const{content:k,timestamp:I,author:i}=d,T=`https://cdn.discordapp.com/avatars/${i.id}/${i.avatar}.png?size=4096`;try{const t=await fetch("https://quote-cardgen.onrender.com/api/generate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:k,username:i.username,timestamp:I,avatarUrl:T})});if(!t.ok)return{content:"\u274C Failed to generate quote card."};const q=await(await t.blob()).arrayBuffer(),w=new Uint8Array(q),D={id:Date.now().toString(),filename:"quote.png",mimeType:"image/png",data:w},C={content:"",tts:!1,invalidEmojis:[],validNonShortcutEmojis:[]};return await u([{channelId:e.channel.id,items:[D],parsedMessage:C,token:m}]),null}catch(t){return console.error("Quote error:",t),{content:"\u274C An error occurred while sending the quote."}}}return n.default=p,Object.defineProperty(n,"__esModule",{value:!0}),n})({},vendetta.commands,vendetta.metro);
