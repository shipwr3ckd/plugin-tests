(function(o,s,t,c,g,a,m,y,r){"use strict";const u=s.findByProps("openLazy","hideActionSheet"),d=s.findByProps("ActionSheetRow")?.ActionSheetRow??m.Forms.FormRow;s.findByStoreName("MessageStore"),s.findByStoreName("ChannelStore");const p=t.stylesheet.createThemedStyleSheet({icon:{width:24,height:24,tintColor:g.semanticColors.INTERACTIVE_NORMAL}});function A(){return c.before("openLazy",u,function(v){let[B,I,{message:n}]=v;I!=="MessageLongPressActionSheet"||!n||B.then(function(N){const T=c.after("default",N,function(_,C){t.React.useEffect(function(){return function(){return T()}},[]);const i=y.findInReactTree(C,function(e){return Array.isArray(e)&&e[0]?.type?.name==="ActionSheetRow"});if(!i)return;const E=Math.max(i.findIndex(function(e){return e?.props?.message===t.i18n.Messages.MARK_UNREAD}),0);i.splice(E,0,t.React.createElement(d,{label:"Quote Message",icon:t.React.createElement(d.Icon,{source:a.getAssetIDByName("ic_message_copy"),IconComponent:function(){return t.React.createElement(t.ReactNative.Image,{resizeMode:"contain",style:p.icon,source:a.getAssetIDByName("ic_message_copy")})}}),onPress:async function(){try{const e=n.channel_id,M=`https://cdn.discordapp.com/avatars/${n.author.id}/${n.author.avatar}.png?size=256`,f=await fetch("https://quote-cardgen.onrender.com/api/generate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:n.content,username:n.author.username,timestamp:n.timestamp,avatarUrl:M})});if(!f.ok){r.showToast("\u274C Failed to generate quote image",a.getAssetIDByName("Small"));return}const D=await f.arrayBuffer(),l=new FormData;l.append("file",new Blob([D],{type:"image/png"}),"quote.png"),await fetch(`/channels/${e}/messages`,{method:"POST",body:l}),r.showToast("\u2705 Quote sent!",a.getAssetIDByName("Check"))}catch(e){console.error("Quote error:",e),r.showToast("\u274C Error sending quote",a.getAssetIDByName("Small"))}finally{u.hideActionSheet()}}}))})})})}let h;const S=function(){h=A()},w=function(){h?.()},R={};return o.onLoad=S,o.onUnload=w,o.settings=R,o})({},vendetta.metro,vendetta.metro.common,vendetta.patcher,vendetta.ui,vendetta.ui.assets,vendetta.ui.components,vendetta.utils,vendetta.ui.toasts);
