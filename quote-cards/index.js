(function(a,c,e,o){"use strict";const u=e.findByStoreName("MessageStore"),l=e.findByStoreName("UserStore"),{uploadLocalFiles:m}=e.findByProps("uploadLocalFiles"),{getToken:p}=e.findByProps("getToken"),g=p();let d;var f={onLoad(){d=c.registerCommand({name:"quote",displayName:"quote",description:"Generate a quote image from a message",displayDescription:"Generate a quote image from a message",inputType:1,type:1,applicationId:"-1",execute:async function(v,s){const r=s?.messageReference?.message_id;if(!r)return o.showToast("Reply to a message to quote it."),{content:"\u274C Please reply to a message."};const t=u.getMessage(s.channel.id,r);if(!t)return o.showToast("Unable to find the message."),{content:"\u274C Failed to find message."};const i=l.getUser(t.author.id),y=i?.username??"Unknown",h=`https://cdn.discordapp.com/avatars/${i.id}/${i.avatar}.png?size=4096`,q={text:t.content,username:y,timestamp:t.timestamp??Date.now(),avatarUrl:h};try{const n=await fetch("https://quote-cardgen.onrender.com/api/generate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(q)});if(!n.ok)throw new Error("Bad response from API");const w=await n.blob(),T=new File([w],"quote.png",{type:"image/png"});return m([{channelId:s.channel.id,files:[T],message:{content:"",tts:!1},replyTo:r,token:g}])}catch(n){return console.error("Failed to send quote",n),o.showToast("\u274C Error generating quote"),{content:"\u274C Failed to generate quote."}}}})},onUnload(){d?.()}};return a.default=f,Object.defineProperty(a,"__esModule",{value:!0}),a})({},vendetta.commands,vendetta.metro,vendetta.ui.toasts);
