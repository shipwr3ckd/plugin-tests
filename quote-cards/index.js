(function(f,a,h,t,n,y,S,s){"use strict";const c=a.findByProps("openLazy","hideActionSheet"),u=a.findByProps("ActionSheetRow")?.ActionSheetRow??y.Forms.FormRow,A=a.findByStoreName("MessageStore"),v=a.findByProps("sendMessage","receiveMessage"),w=t.stylesheet.createThemedStyleSheet({iconComponent:{width:24,height:24,tintColor:"#5865F2"}});function N(){return h.before("openLazy",c,function(d){let[,R,m]=d;const o=m?.message;R!=="MessageLongPressActionSheet"||!o||m.component.then(function(B){const C=h.before("default",B,function(D,M){t.React.useEffect(function(){return function(){return C()}},[]);const i=S.findInReactTree(M,function(e){return Array.isArray(e)&&e.find(function(l){return l?.type?.displayName===u.displayName})});if(!i)return;const p=i.findIndex(function(e){return e.props.label.includes("Reply")}),T=p>=0?p+1:i.length;i.splice(T,0,t.React.createElement(u,{label:"Quote Message",icon:t.React.createElement(u.Icon,{source:n.getAssetIDByName("Quote"),IconComponent:function(){return t.React.createElement(t.ReactNative.Image,{style:w.iconComponent,source:n.getAssetIDByName("Quote")})}}),onPress:async function(){s.showToast("\u{1F3A8} Generating quote\u2026",n.getAssetIDByName("Small"));const e=A.getMessage(o.channel_id,o.id);if(!e){s.showToast("\u274C Message not found.",n.getAssetIDByName("Small")),c.hideActionSheet();return}const l=`https://cdn.discordapp.com/avatars/${e.author.id}/${e.author.avatar}.png?size=128`,P={text:e.content||"[No text]",username:e.author.username,timestamp:e.timestamp,avatarUrl:l};try{const r=await fetch("https://quote-cardgen.onrender.com/api/generate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(P)});if(!r.ok)throw new Error("API failed");const b=await r.blob(),g=new FormData;g.append("file",b,"quote.png"),v.sendMessage(o.channel_id,{content:"",messageReference:{message_id:o.id},files:g,invalidEmojis:[],validNonShortcutEmojis:[],attachments:[]}),s.showToast("\u2705 Quote sent!",n.getAssetIDByName("Check"))}catch(r){console.error(r),s.showToast("\u274C Quote failed.",n.getAssetIDByName("Small"))}finally{c.hideActionSheet()}}}))})})})}const I=function(){const d=N();return function(){return d()}};return f.onLoad=I,f})({},vendetta.metro,vendetta.patcher,vendetta.metro.common,vendetta.ui.assets,vendetta.ui.components,vendetta.utils,vendetta.ui.toasts);
