(function(s,n,u,t,o,g,y,i){"use strict";const d=n.findByProps("openLazy","hideActionSheet"),l=n.findByProps("ActionSheetRow")?.ActionSheetRow??g.Forms.FormRow,m=n.findByStoreName("MessageStore");n.findByStoreName("ChannelStore");const S=n.findByProps("sendMessage"),A=t.stylesheet.createThemedStyleSheet({iconComponent:{width:24,height:24,tintColor:"#5865F2"}});function w(){return u.before("openLazy",d,function(v){let[R,I,N]=v;const a=N?.message;I!=="MessageLongPressActionSheet"||!a||R.then(function(b){const B=u.before("default",b,function(T,E){t.React.useEffect(function(){return function(){return B()}},[]);const r=y.findInReactTree(E,function(e){return Array.isArray(e)&&e.find(function(c){return c?.type?.name==="ActionSheetRow"})});if(!r)return;const f=r.findIndex(function(e){return typeof e.props.label=="string"&&e.props.label.includes(t.i18n.Messages.REPLY)}),M=f>=0?f+1:r.length;r.splice(M,0,t.React.createElement(l,{label:"Quote Message",icon:t.React.createElement(l.Icon,{source:o.getAssetIDByName("Quote"),IconComponent:function(){return t.React.createElement(t.ReactNative.Image,{style:A.iconComponent,source:o.getAssetIDByName("Quote")})}}),onPress:async function(){try{i.showToast("\u{1F3A8} Generating quote\u2026",o.getAssetIDByName("Small"));const e=m.getMessage(a.channel_id,a.id);if(!e)throw new Error("Original not found");const c=`https://cdn.discordapp.com/avatars/${e.author.id}/${e.author.avatar}.png?size=128`,P={text:e.content||"[No text]",username:e.author.username,timestamp:e.timestamp,avatarUrl:c},h=await fetch("https://quote-cardgen.onrender.com/api/generate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(P)});if(!h.ok)throw new Error("API failed");const C=await h.blob(),p=new FormData;p.append("file",C,"quote.png"),S.sendMessage(a.channel_id,{content:"",messageReference:{message_id:a.id},files:p,invalidEmojis:[],validNonShortcutEmojis:[],attachments:[]}),i.showToast("\u2705 Quote sent!",o.getAssetIDByName("Check"))}catch(e){console.error("Quote error:",e),i.showToast("\u274C Unable to quote",o.getAssetIDByName("Small"))}finally{d.hideActionSheet()}}}))})})})}return s.default=w,Object.defineProperty(s,"__esModule",{value:!0}),s})({},vendetta.metro,vendetta.patcher,vendetta.metro.common,vendetta.ui.assets,vendetta.ui.components,vendetta.utils,vendetta.ui.toasts);
