(function(o,l,t,a,s){"use strict";const m=t.findByStoreName("MessageStore");t.findByStoreName("ChannelStore");const f=t.findByProps("sendMessage","receiveMessage"),g=t.findByProps("showActionSheet");function p(r,n){return`https://cdn.discordapp.com/avatars/${r}/${n}.png?size=128`}let d;var y={onLoad(){d=l.before("showActionSheet",g,function(r){const[n]=r,{message:i,channelId:c}=n;!i?.id||!c||n.options.push({text:"Quote",icon:{type:0,name:"Quote"},onPress:async function(){try{s.showToast("\u{1F3A8} Generating quote\u2026",a.getAssetIDByName("Small"));const e=m.getMessage(c,i.id);if(!e)throw new Error("Message not found");const w=p(e.author.id,e.author.avatar),v={text:e.content||"[No text]",username:e.author.username,timestamp:e.timestamp,avatarUrl:w},u=await fetch("https://quote-cardgen.onrender.com/api/generate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(v)});if(!u.ok)throw new Error("API failed");const S=await u.blob(),h=new FormData;h.append("file",S,"quote.png"),f.sendMessage(c,{content:"",messageReference:{message_id:i.id},invalidEmojis:[],validNonShortcutEmojis:[],attachments:[],files:h}),s.showToast("\u2705 Quote sent!",a.getAssetIDByName("Check"))}catch(e){console.error("Quote action error:",e),s.showToast("\u274C Failed to quote",a.getAssetIDByName("Small"))}}})})},onUnload(){d?.()}};return o.default=y,Object.defineProperty(o,"__esModule",{value:!0}),o})({},vendetta.patcher,vendetta.metro,vendetta.ui.assets,vendetta.ui.toasts);
