(function(r,a,f,t,n,y,S,i){"use strict";const u=a.findByProps("openLazy","hideActionSheet"),d=a.findByProps("ActionSheetRow")?.ActionSheetRow??y.Forms.FormRow,A=a.findByStoreName("MessageStore"),v=a.findByProps("sendMessage","receiveMessage"),w=t.stylesheet.createThemedStyleSheet({iconComponent:{width:24,height:24,tintColor:"#5865F2"}});function N(){return f.before("openLazy",u,function(B){let[,C,m]=B;const o=m?.message;C!=="MessageLongPressActionSheet"||!o||m.component.then(function(M){const T=f.before("default",M,function(Q,P){t.React.useEffect(function(){return function(){return T()}},[]);const s=S.findInReactTree(P,function(e){return Array.isArray(e)&&e.find(function(l){return l?.type?.displayName===d.displayName})});if(!s)return;const p=s.findIndex(function(e){return e.props.label.includes("Reply")}),b=p>=0?p+1:s.length;s.splice(b,0,t.React.createElement(d,{label:"Quote Message",icon:t.React.createElement(d.Icon,{source:n.getAssetIDByName("Quote"),IconComponent:function(){return t.React.createElement(t.ReactNative.Image,{style:w.iconComponent,source:n.getAssetIDByName("Quote")})}}),onPress:async function(){i.showToast("\u{1F3A8} Generating quote\u2026",n.getAssetIDByName("Small"));const e=A.getMessage(o.channel_id,o.id);if(!e){i.showToast("\u274C Message not found.",n.getAssetIDByName("Small")),u.hideActionSheet();return}const l=`https://cdn.discordapp.com/avatars/${e.author.id}/${e.author.avatar}.png?size=128`,D={text:e.content||"[No text]",username:e.author.username,timestamp:e.timestamp,avatarUrl:l};try{const c=await fetch("https://quote-cardgen.onrender.com/api/generate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(D)});if(!c.ok)throw new Error("API failed");const E=await c.blob(),g=new FormData;g.append("file",E,"quote.png"),v.sendMessage(o.channel_id,{content:"",messageReference:{message_id:o.id},files:g,invalidEmojis:[],validNonShortcutEmojis:[],attachments:[]}),i.showToast("\u2705 Quote sent!",n.getAssetIDByName("Check"))}catch(c){console.error(c),i.showToast("\u274C Quote failed.",n.getAssetIDByName("Small"))}finally{u.hideActionSheet()}}}))})})})}let h;const I=function(){h=N()},R=function(){h?.()};return r.onLoad=I,r.onUnload=R,r})({},vendetta.metro,vendetta.patcher,vendetta.metro.common,vendetta.ui.assets,vendetta.ui.components,vendetta.utils,vendetta.ui.toasts);
