(function(i,r,s,f){"use strict";const m=r.findByProps("openLazy","hideActionSheet"),{uploadLocalFiles:h}=r.findByProps("uploadLocalFiles"),{getToken:y}=r.findByProps("getToken");let p;function v(){p=s.after("openLazy",m,function(e,c){let[u,t]=e;if(u!=="MessageLongPressActionSheet")return;const n=t?.[0]?.message;!n?.author?.id||!n?.content||s.after("default",c,function(o){let[d]=o;const a=d?.type?.render;a&&s.after("render",a,function(l,A){let[q]=l;const g=q?.actionSheet?.rows;Array.isArray(g)&&g.push({label:"\u{1F4CB} Quote Message",icon:f.getAssetIDByName("ic_copy_message_link"),isDestructive:!1,onPress:function(){return P(n)}})})})})}const w=function(){return p?.()};async function P(e){const c=`https://cdn.discordapp.com/avatars/${e.author.id}/${e.author.avatar}.png?size=4096`,u={text:e.content,username:e.author.username,timestamp:e.timestamp,avatarUrl:c};try{const t=await fetch("https://quote-cardgen.onrender.com/api/generate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(u)});if(!t.ok)throw new Error("Quote API returned an error");const n=await(await t.blob()).arrayBuffer(),o=new File([n],"quote.png",{type:"image/png"}),d=y(),a=[{item:{id:"quote-card",uri:o.uri??"",originalUri:o.uri??"",mimeType:"image/png",filename:"quote.png",width:800,height:400,playableDuration:0},id:"quote-card",filename:"quote.png",isImage:!0,isVideo:!1,mimeType:"image/png",origin:1}],l={content:"",tts:!1,invalidEmojis:[],validNonShortcutEmojis:[]};h([{ctx:{channel:e.channel_id},items:a,token:d,parsedMessage:l}])}catch(t){console.error("\u274C Failed to generate and send quote:",t)}}var b={onLoad:v,onUnload:w};return i.default=b,Object.defineProperty(i,"__esModule",{value:!0}),i})({},vendetta.metro,vendetta.patcher,vendetta.ui.assets);
