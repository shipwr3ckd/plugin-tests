(function(a,S,o,r,s){"use strict";const w=o.findByProps("openLazy");o.findByStoreName("MessageStore");const A=o.findByProps("sendMessage","receiveMessage"),N=function(i,c){return`https://cdn.discordapp.com/avatars/${i}/${c}.png?size=128`};let p;var P={onLoad(){p=S.after("openLazy",w,function(i,c){let[B,q]=i;B==="MessageLongPressActionSheet"&&c.then(function(u){const l=u.default?.render??u.default;l&&(u.default=function(){for(var h=arguments.length,f=new Array(h),t=0;t<h;t++)f[t]=arguments[t];const n=l(...f),m=n?.props?.actionSheet?.props?.children;return Array.isArray(m)&&m.push({label:"Quote",onPress:async function(){const e=n?.props?.actionSheet?.props?.message,g=n?.props?.actionSheet?.props?.channel?.id;if(!(!e||!g))try{r.showToast("\u{1F5BC} Generating quote\u2026",s.getAssetIDByName("Small"));const d=N(e.author.id,e.author.avatar),M={text:e.content||"[No text]",username:e.author.username,timestamp:e.timestamp,avatarUrl:d},y=await fetch("https://quote-cardgen.onrender.com/api/generate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(M)});if(!y.ok)throw new Error("API error");const b=await y.blob(),v=new FormData;v.append("file",b,"quote.png"),A.sendMessage(g,{content:"",messageReference:{message_id:e.id},invalidEmojis:[],validNonShortcutEmojis:[],attachments:[],files:v}),r.showToast("\u2705 Quote sent!",s.getAssetIDByName("Check"))}catch(d){console.error("Quote plugin error",d),r.showToast("\u274C Failed to quote",s.getAssetIDByName("Small"))}}}),n})})})},onUnload(){p?.()}};return a.default=P,Object.defineProperty(a,"__esModule",{value:!0}),a})({},vendetta.patcher,vendetta.metro,vendetta.ui.toasts,vendetta.ui.assets);
