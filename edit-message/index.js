(function(i,o,s,r,p,g,u){"use strict";const a=o.findByProps("openLazy","hideActionSheet"),c=o.findByProps("ActionSheetRow")?.ActionSheetRow,y=o.findByStoreName("MessageStore");let d;function M(){d=r.after("openLazy",a,function(R){let[E,v]=R;v==="MessageLongPressActionSheet"&&E.then(function(b){r.after("default",b,function(B,I){let[f]=B;const t=g.findInReactTree(I,function(e){return Array.isArray(e)&&e.some(function(n){return n?.type===c})});if(!t||t.some(function(e){return e?.props?.label==="Edit Message"}))return;const l=t.findIndex(function(e){return e?.props?.label==="Reply"}),L=l>-1?l:Math.max(t.findIndex(function(e){return e?.props?.label==="Copy Text"}),0);t.splice(L,0,s.React.createElement(c,{label:"Edit Message",icon:s.React.createElement(c.Icon,{source:p.getAssetIDByName("ic_pencil_24px")}),onPress:function(){try{const e=f?.message?.id,n=f?.message?.channel_id;if(!e||!n)return;const h=y.getMessage(n,e);if(!h)return;u.showModal(s.React.createElement(u.ModalRoot,{title:"Edit Message",defaultValue:h.content,onClose:function(){return a.hideActionSheet()},onSubmit:function(P){const{editMessage:w}=o.findByProps("editMessage");w(n,e,{content:P}),a.hideActionSheet()}}))}catch(e){console.error("Edit Message error",e)}}}))})})})}function S(){d?.()}const A=function(){M()},m=function(){S()};return i.onLoad=A,i.onUnload=m,i})({},vendetta.metro,vendetta.metro.common,vendetta.patcher,vendetta.ui.assets,vendetta.utils,vendetta.ui.modals);
